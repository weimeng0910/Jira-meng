# Webpackï¼šTypeScript + Jest + Sass + ESLint

#ğŸŒˆ ğŸš€ React18 Hook + typescript4 + Jest ğŸš€

# å‰è¨€

ä»é›¶é…ç½®åŸºäº webpack5.74.0 æ­å»º React åº”ç”¨æ¨¡æ¿ï¼Œæ–¹ä¾¿å¿«é€Ÿçš„è¿›è¡Œå¼€å‘ï¼ŒReactï¼ˆReact Hook + React-router + Axios ï¼‰ESLint ç­‰é¡¹ç›®å¼€å‘è§„èŒƒç­‰ã€‚

# æŠ€æœ¯æ ˆ

æ¶‰åŠçš„æŠ€æœ¯æ ˆå‡é‡‡ç”¨å½“å‰æœ€æ–°çš„ç‰ˆæœ¬å’Œè¯­æ³•ï¼š

-   ä½¿ç”¨ Webpack5.7.1 æ„å»ºé¡¹ç›®ï¼ˆä¸ä½¿ç”¨ create-react-appã€umi ç­‰è„šæ‰‹æ¶ï¼‰ï¼›
-   ä½¿ç”¨ Babel8 é…ç½®è½¬æ¢ ES6ã€Reactã€Mobx ç­‰è¯­æ³•ï¼›
-   ä½¿ç”¨ TypeScript è¿›è¡Œä¸¥æ ¼ç±»å‹æ£€æŸ¥ï¼›
-   ä½¿ç”¨ ESLint ä»£ç è§„èŒƒæ ¡éªŒï¼ŒPrettier stylelint ä»£ç è‡ªåŠ¨æ ¼å¼åŒ–å·¥å…·ï¼ŒEditorConfig ä»£ç é£æ ¼ç»Ÿä¸€å·¥å…·
-   React ç‰ˆæœ¬ V18.0.0ï¼Œå…¨éƒ¨é‡‡ç”¨å‡½æ•°åŒ– Hooks ç‰¹æ€§å¼€å‘é¡¹ç›®ç»„ä»¶ï¼›l
-   é‡‡ç”¨ React-router6 å·¥å…· é…ç½®é¡¹ç›®è·¯ç”±ï¼›
-   é‡‡ç”¨ Redux + Hooks å’Œ URl å®ç°é¡¹ç›®æ•°æ®çŠ¶æ€ç®¡ç†ï¼›
-   å°è£… Axios åº“å®ç°ä¸åå° http è¯·æ±‚äº¤äº’ï¼›

## ç›®å½•ç»“æ„

```
â”œâ”€â”€ config                   // webpacké…ç½®
â”‚Â Â  â”œâ”€â”€ webpack.common.js   // webpacké€šç”¨é…ç½®
â”‚Â Â  â”œâ”€â”€ webpack.dev.js      // webpackå¼€å‘ç¯å¢ƒé…ç½®
â”‚Â Â  â””â”€â”€ webpack.prod.js     // webpackç”Ÿäº§ç¯å¢ƒé…ç½®
â”‚Â Â  â””â”€â”€ paths.js            // webpackè·¯å¾„é…ç½®
â”œâ”€â”€ dist                    // æ‰“åŒ…è¾“å‡ºç›®å½•
â”œâ”€â”€ public                  // é¡¹ç›®å…¬å¼€ç›®å½•
â”œâ”€â”€ text                    // æµ‹è¯•ç›®å½•
â”œâ”€â”€ src                     // srcå¼€å‘ç›®å½•
â”‚Â Â  â”œâ”€â”€ assets              // svgå›¾ç‰‡
â”‚Â Â  â”œâ”€â”€ _tests_             // Jestæµ‹è¯•
â”‚Â Â  â”œâ”€â”€ mocks               // serverï¼ŒJwt
â”‚Â Â  â”œâ”€â”€ components          // å…¬å…±ç»„ä»¶
â”‚Â  Â â”‚    â”œâ”€â”€ lib            // Emotioné…åˆ¶çš„CSSæ ·å¼ç»„ä»¶
â”‚Â Â  â”œâ”€â”€ routers             // é¡¹ç›®è·¯ç”±é…ç½®
â”‚Â Â  â”œâ”€â”€ views               // å…·ä½“ä¸šåŠ¡é¡µé¢
â”‚Â Â  â”œâ”€â”€ context             // å…¨å±€ç”¨æˆ·ä¿¡æ¯
â”‚Â Â  â”œâ”€â”€ types               // å…¨å±€å…¬å…±ç±»å‹å®šä¹‰
â”‚Â Â  â”œâ”€â”€ utils               // å·¥å…·åº“/é€šç”¨å‡½æ•°
â”‚Â Â  â”œâ”€â”€ typings.d.ts        // css modules ç±»å‹å£°æ˜æ–‡ä»¶
â”‚Â Â  â”œâ”€â”€ index.html          // å…¥å£htmlé¡µé¢
â”‚Â Â  â””â”€â”€ index.tsx           // é¡¹ç›®å…¥å£æ–‡ä»¶
â”œâ”€â”€ .babel.config.js         // babelé…ç½®,ä¾èµ–ä»€ä¹ˆæ ·çš„æ’ä»¶
â”œâ”€â”€ .browserslistrc         // æµè§ˆå™¨è¿‡æ»¤è§„åˆ™é…ç½®,babelä¾èµ–è¿™ä¸ªæ–‡ä»¶ï¼ŒåŒæ ·cssä¹Ÿä¾èµ–
â”œâ”€â”€ .editorconfig            // é¡¹ç›®æ ¼å¼é…ç½®
â”œâ”€â”€ .eslintrc.json          // ESLinté…ç½®
â”œâ”€â”€ .eslintignore           // ESLinté…ç½®å±è”½ä¸éœ€è¦æ£€æµ‹çš„æ–‡ä»¶æˆ–ç›®å½•
â”œâ”€â”€ .prettierrc.js          // Prettier ä»£ç è‡ªåŠ¨æ ¼å¼åŒ–é…ç½®
â”œâ”€â”€ .prettierignore         // Prettier ä»£ç è‡ªåŠ¨æ ¼å¼åŒ–é…ç½®å±è”½ä¸å¿…è¦çš„æ–‡ä»¶
â”œâ”€â”€ .editorconfig            // EditorConfig ä»£ç é£æ ¼ç»Ÿä¸€é…ç½®
â”œâ”€â”€ .jest.config.js          // jestä»£ç æµ‹è¯•é…ç½®
â”œâ”€â”€ .stylelintrc.js         // stylelintæ˜¯CSS è§„èŒƒæ ¡éªŒå·¥å…·é…ç½®
â”œâ”€â”€ .gitignore              // git å¿½ç•¥é…ç½®
â”œâ”€â”€ .postcssrc.js           // postcssé…ç½®,ä¾èµ–ä»€ä¹ˆæ ·çš„æ’ä»¶
â”œâ”€â”€ tsconfig.json            // typescripté…ç½®
â”œâ”€â”€ package.json            // ä¾èµ–åŒ…é…ç½®
â””â”€â”€ README.md               // é¡¹ç›®è¯´æ˜


```

### æœ¬åœ° node æœåŠ¡å™¨

### é…åˆ¶ json-serve

ä¼˜ç‚¹ï¼š
1ã€é…åˆ¶ç®€å•,json-server å¯ä»¥ç¬é—´èµ·åŠ¨ REST API Server 2.å¢åˆ æ”¹æŸ¥çœŸå®æ¨¡æ‹Ÿ

ç¼ºç‚¹ï¼šä¸æ¥å£ç®¡ç†å·¥å…·ç›¸æ¯”ï¼Œæ— æ³•éšåç«¯ API çš„ä¿®æ”¹è€Œè‡ªåŠ¨ä¿®æ”¹

```

yarn add json-server

```

## ä½¿ç”¨ dotenv åŠ è½½.env---å…¨å±€ç¯å¢ƒå˜é‡

```

yarn add -D dotenv-webpack

```

dotenv æ˜¯ä¸€ä¸ªé›¶ä¾èµ–æ¨¡å—ï¼Œå®ƒå°†ç¯å¢ƒå˜é‡ä» .env æ–‡ä»¶åŠ è½½åˆ° process.env ä¸­ã€‚dotenv æä¾›è®¸å¤šçš„æ–¹æ³•ï¼Œæœ€å¸¸ç”¨çš„æ˜¯ dotenv.config()ã€‚
æœ€å¸¸ç”¨çš„æ˜¯é…åˆ¶.env æ–‡ä»¶ï¼Œå¯ä»¥é…åˆ¶ä¸Šçº¿æ‰€éœ€è¦çš„ API æ¥å£çš„ URL,å‡¡æ˜¯åœ¨ .env è®¾ç½®çš„å…¨å±€å˜é‡ï¼Œä¸€å¾‹éƒ½æ˜¯ä½¿ç”¨ process.env.XXX å°‡å…¶è¯»å–ï¼Œé€™é‚Šå”¯ä¸€è¦æ³¨æ„çš„æ˜¯ .env è®¾ç½®çš„å…¨å±€å˜é‡éƒ½æ˜¯å±äºå­—ç¬¦ä¸²ï¼Œåœ¨æŸäº›æƒ…æ³ä¸‹æˆ‘ä»¬å¾—è‡ªå·±å¤„ç†è½¬å‹çš„é—®é¡Œã€‚

ä¸€ã€ .env æ–‡ä»¶è¯´æ˜

.env --- å…¨å±€é»˜è®¤é…ç½®æ–‡ä»¶ï¼Œåœ¨æ‰€æœ‰çš„ç¯å¢ƒä¸­è¢«è½½å…¥

.env.development --- æŒ‡å®šå¼€å‘ç¯å¢ƒçš„é…ç½®æ–‡ä»¶

.env.production --- æŒ‡å®šç”Ÿäº§ç¯å¢ƒçš„é…ç½®æ–‡ä»¶ï¼Œå½“ build è¿è¡Œä¼šè§¦å‘æ­¤æ–‡ä»¶

äºŒã€åœ¨æ ¹ç›®å½•ä¸‹å»ºç«‹ä¸¤ä¸ªæ–‡ä»¶ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œåªå»ºç«‹.env å’Œ.env.development ä¸¤ä¸ªæ–‡ä»¶

```
 webpack-demo/
 â”‚
+â””â”€â”€â”€ .env
+â””â”€â”€â”€ env.development

```

å…ˆåœ¨.env æ–‡ä»¶ä¸­å£°æ˜ç¯å¢ƒå˜é‡ï¼Œç„¶åæ— è®ºä½ æƒ³åœ¨å“ªé‡Œä½¿ç”¨å˜é‡ .env éƒ½å¯ç”¨ä¸‹é¢çš„æ–¹å¼

```
process.env.REACT_APP_YOURVARIABLE
```

å…¨å±€é»˜è®¤é…ç½®æ–‡ä»¶ï¼Œæ— è®ºä»€ä¹ˆç¯å¢ƒéƒ½ä¼šåŠ è½½åˆå¹¶,æˆ‘ä»¬åœ¨è¿™é‡Œè®¾ç½®ä¸Šçº¿è¿è¡Œæ—¶çš„ URl åœ°å€

```
REACT_APP_API_URL=online.com

```

åœ¨.env.development æ–‡ä»¶ä¸­è®¾ç½®å¼€å‘æ—¶çš„ URl åœ°å€ï¼Œå‚è€ƒå¦‚ä¸‹

```
REACT_APP_API_URL=http://localhost:5000

```

ä¸‰.å°†å…¨å±€å˜é‡æ–‡ä»¶åœ¨ github ä¸­éšè—

ç›®å‰ï¼Œæˆ‘ä»¬åªæ˜¯å°†å…¨å±€å˜é‡çš„ API è¯·æ±‚åœ°å€å†™åˆ°.env æ–‡ä»¶å†…ï¼Œä¸ºäº†è¾¾åˆ°éšè—ç›®çš„ï¼Œå¯å°†å…¶æ–°å¢è‡³.gitignore å†…ï¼Œè¿™æ ·å¯ä»¥é¿å… GitHub å†…å­˜åœ¨ä»»ä½•å‹æ€çš„å…¨å±€å˜é‡

```
.env
.env.development

```

å››ã€dotenv-webpack å¯ä¼ å‚é€‰é¡¹
å¯å‚è€ƒ dotenv-webpack Options å¯ä¼ å‚åˆ—è¡¨ï¼Œä»¥ä¸‹ä¸ºå¸¸ç”¨å‚æ•°é…ç½®ï¼š
path: String
é…ç½®å…¨å±€å˜ç†ä½ç½®ï¼Œé»˜è®¤ä¸º./.env

systemvars:Boolean
å……è®¸åŠ è½½æ‰€æœ‰ç³»ç»Ÿå˜é‡

åœ¨ webpack.common.jsï¼Œå†…å®¹å¦‚ä¸‹

```
const Dotenv = require("dotenv-webpack");

module.exports = {
  plugins: [
    new Dotenv({
      path:
        process.env.NODE_ENV === "development"
          ? "./.env.development"
          : "./.env.production",
      systemvars: true, // å…è¨±è®€å– process.env ä¸‹çš„ä»»æ„ç³»çµ±è®Šé‡
    }),
  ],
};
```

### ä¸ºé¡¹ç›®æ·»åŠ  UI åº“-Antd

å®‰è£… Antd ä¾èµ–

```
yarn add antd
```

### å‰åç«¯åˆ†ç¦»ä¹‹ JWT+Mock Service Worker

#### Mock Service Worker è¿›è¡Œ mock æ•°æ®

```
yarn add msw
```

### React ä¸­ css-in-js Emotion å®‰è£…å’Œä½¿ç”¨

1.å®‰è£…

```
yarn add @emotion/react @emotion/styled
```

2.å®‰è£…æ’ä»¶
vscode å®‰è£…æ’ä»¶ï¼Œvscode-styled-components 3.ä½¿ç”¨ css é“å…·
emotion æä¾›ä¸€ä¸ª css å¯ä»¥æ¥å—åµŒå¥—é€‰æ‹©å™¨å’Œåª’ä½“æŸ¥è¯¢çš„é“å…·ã€‚å®ƒå¯ä»¥æ”¯æŒå¯¹è±¡æˆ–æ ‡è®°çš„æ¨¡æ¿æ–‡å­—ã€‚

åœ¨ä»£ç ç¼–è¾‘å™¨ä¸­æ‰“å¼€ App.js æ–‡ä»¶å¹¶ä¿®æ”¹å®ƒä»¥å°†<div>s ä¸ cssprop ä¸€èµ·ä½¿ç”¨

/\*_ @jsxImportSource @emotion/react _/åŠ ä¸Šè¿™ä¸ªæ³¨é‡Šæ‰å¯ä»¥åœ¨ div ä¸­ç”¨ css å±æ€§

```
/** @jsxImportSource @emotion/react */
import { css } from '@emotion/react';

function App() {
  return (
    <div>
      <div css={css({
        margin: 10,
        padding: 10,
        backgroundColor: '#eee',
      })}>
        This is an example of <code>`css`</code> using an object.
      </div>
      <div css={css`
        margin: 10px;
        padding: 10px;
        background-color: #eee;
      `}>
        This is an example of <code>`css`</code> using a tagged template literal.
      </div>
    </div>
  );
}

export default App;
```

### React é¡¹ç›®ä¸­ webpack åŠ è½½ svg

1.ä½¿ç”¨ SVG ä½œä¸ºç»„ä»¶

```
yarn add  new-url-loader -D
yarn add -D @svgr/webpack
```

3.å®‰è£… VSCode Extension: SVG Gallery

#### å®‰è£… Day.js å¤„ç†æ—¶é—´

Day.js æ˜¯ä¸€ä¸ªè½»é‡çš„å¤„ç†æ—¶é—´å’Œæ—¥æœŸçš„ JavaScript åº“ï¼Œå’Œ Moment.js çš„ API è®¾è®¡ä¿æŒå®Œå…¨ä¸€æ ·ã€‚

```
yarn add dayjs
```

#### å®‰è£… jwt-decode

```
yarn add jwt-decode
```

ä»£ç ç¤ºä¾‹

```
// ES6
import jwt_decode from "jwt-decode";
decoded = jwt_decode(token)
console.log(decoded);
// { name: 'Tom', age: 23, iat: 1584088910, exp: 1584096110 }
```

#### å®‰è£… react-helmet

æ–‡æ¡£å¤´éƒ¨çš„æ‰€æœ‰æ›´æ”¹,è¿™ä¸ªåŒ…å¯ä»¥åœ¨ React ä¸­æ›´æ”¹å¤´éƒ¨

```
yarn add react-helmet

```

#### å®‰è£… react-router,react-router-dom

è¯´æ˜ï¼šreact-router å·²ç»æ›´æ–°åˆ° 6.4,ä½†å› ä¸ºé¡¹ç›®ä¸­åªç”¨æ¥åšçº¯ç²¹çš„è·¯ç”±ç»„ä»¶ï¼Œæ‰€ä»¥ä½¿ç”¨ 6.3.0

```
yarn add react-router@6.3.0 react-router-dom@6.3.0

```

### ä½¿ç”¨ Why Did You Render è°ƒè¯• React æ€§èƒ½é—®é¢˜

å½“æˆ‘ä»¬å¯ç”¨äº† why render æ’ä»¶å¼€å‘çš„æ—¶å€™ï¼Œå¦‚æœç»„ä»¶é‡Œæœ‰ä¸å¿…è¦çš„ re-render é—®é¢˜æ—¶ï¼Œæ§åˆ¶å°é‡Œä¼šæœ‰ç›¸å…³çš„ä¿¡æ¯æç¤ºï¼ˆä¸ç®¡æ˜¯é¡µé¢åŠ è½½çš„æ—¶å€™è¿˜æ˜¯äº¤äº’çš„æ—¶å€™éƒ½å¯èƒ½ä¼šæœ‰æç¤ºï¼‰

```
yarn add --dev @welldone-software/why-did-you-render
```

### ä½¿ç”¨ React-query ä½¿ React åº”ç”¨ç¨‹åºä¸­çš„è·å–ã€ç¼“å­˜ã€åŒæ­¥å’Œæ›´æ–°æœåŠ¡å™¨çŠ¶æ€å˜å¾—è½»è€Œæ˜“ä¸¾

```
yarn add react-query
```

### ä½¿ç”¨ React-beautiful-dnd æ¥å¯¹çœ‹æ¿å’Œä»»åŠ¡ç»„ä»¶æ‹–æ‹½

```
yarn add react-beautiful-dnd
yarn add @typescript/react-beautiful-dnd -D
```

### ä½¿ç”¨ React Testing Library å’Œ Jest å®Œæˆå•å…ƒæµ‹è¯•

```
yarn add mws -D
yarn add @testing-library/react-hooks -D
yarn add @testing-library/jest-dom @testing-library/react @testing-library/user-event @types/testing-library__jest-dom -D
yarn add babel-jest @babel/core @babel/preset-env @babel/preset-react @babel/preset-typescript -D
yarn add @testing-library/user-event -D
yarn add identity-obj-proxy -D

```
